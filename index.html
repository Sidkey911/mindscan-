<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MindScan Lite - Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="icon-192.png" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <link rel="manifest" href="manifest.json" />
</head>
<body>
  <header class="header">
    <div class="header-top">
      <h1>MindScan Lite</h1>
      <button type="button" class="btn theme-toggle" id="themeToggle">
        Switch theme
      </button>
    </div>
    <p class="subtitle">
      Welcome to MindScan Lite â€“ a simple wellness checker for daily self-awareness.
      <br />
      Please fill in your basic profile, then we will bring you to the MindScan page.
    </p>
  </header>

  <main class="container">
    <section class="card main-card" id="loginCard">
      <h2>Login / Profile</h2>
      <p class="hint">
        Your details are stored only on this device (local storage). You can change them anytime.
      </p>

      <form id="loginForm">
        <label>
          Full Name
          <input type="text" name="name" required />
        </label>

        <label>
          Age
          <input type="number" name="age" min="10" max="80" required />
        </label>

        <label>
          Gender
          <select name="gender" required>
            <option value="">Select...</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </label>

        <label>
          Student ID (optional)
          <input type="text" name="studentId" />
        </label>

        <label>
          Course / Class
          <input type="text" name="course" />
        </label>

        <label>
          Email (optional)
          <input type="email" name="email" />
        </label>

        <div class="form-actions">
          <button type="submit" class="btn primary">Save & go to MindScan</button>
        </div>
      </form>

      <p class="hint" style="margin-top:10px;">
        If you have used MindScan Lite before on this device, your profile will be loaded automatically.
      </p>
    </section>
  </main>

  <footer class="footer">
    <small>MindScan Lite - Wellness ICT demo for self awareness only</small>
  </footer>

  <script>
    // same theme handling as app.js
    (function () {
      const themeToggle = document.getElementById("themeToggle");
      function initTheme() {
        const stored = localStorage.getItem("mindscan_theme") || "light";
        if (stored === "dark") {
          document.body.classList.add("theme-light-dark");
          if (themeToggle) themeToggle.textContent = "Switch to light theme";
        } else {
          if (themeToggle) themeToggle.textContent = "Switch to dark theme";
        }
      }
      initTheme();

      if (themeToggle) {
        themeToggle.addEventListener("click", () => {
          const isDark = document.body.classList.toggle("theme-light-dark");
          localStorage.setItem("mindscan_theme", isDark ? "dark" : "light");
          themeToggle.textContent = isDark
            ? "Switch to light theme"
            : "Switch to dark theme";
        });
      }

      const PROFILE_KEY = "mindscan_profile_v1";
      function loadProfile() {
        try {
          const raw = localStorage.getItem(PROFILE_KEY);
          if (!raw) return {};
          const data = JSON.parse(raw);
          return data || {};
        } catch {
          return {};
        }
      }
      function saveProfile(p) {
        try {
          localStorage.setItem(PROFILE_KEY, JSON.stringify(p));
        } catch (e) {
          console.log("Save profile error", e);
        }
      }

      const loginForm = document.getElementById("loginForm");
      if (loginForm) {
        // prefill if profile exists
        const p = loadProfile();
        const f = loginForm.elements;
        if (p.name) f.name.value = p.name;
        if (p.age) f.age.value = p.age;
        if (p.gender) f.gender.value = p.gender;
        if (p.studentId) f.studentId.value = p.studentId;
        if (p.course) f.course.value = p.course;
        if (p.email) f.email.value = p.email;

        loginForm.addEventListener("submit", function (e) {
          e.preventDefault();
          const profile = {
            name: f.name.value.trim(),
            age: f.age.value,
            gender: f.gender.value,
            studentId: f.studentId.value.trim(),
            course: f.course.value.trim(),
            email: f.email.value.trim()
          };
          if (!profile.name || !profile.age || !profile.gender) {
            alert("Please fill in name, age and gender.");
            return;
          }
          saveProfile(profile);
          // go to main MindScan page
          window.location.href = "mindscan.html";
        });
      }
    })();
  </script>
</body>
</html>

